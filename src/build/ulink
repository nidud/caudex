# ULINK--
#
# ulink(color)
#
count = CharCnt()
i = 0
while ( i < count )

  Select(i)
  c = GlyphInfo("Color")
  m = GlyphInfo("ValidationState")
  if ( $1 == c )

    UnlinkReference()
    if ( m & 0x10 )
        CorrectDirection()
    endif
    RoundToInt()
  endif
  ++i;
endloop

Validate(1)

i = 0
while ( i < count )

  Select(i)
  c = GlyphInfo("Color")
  if ( $1 == c )

    m = GlyphInfo("ValidationState")
    if ( m & 0x1 )
        if ( m & 0x4 )
            RemoveOverlap()
            RoundToInt()
        endif
        if ( m & 0x20 )
            AddExtrema()
            RoundToInt()
            AddExtrema()
        endif
    endif
    RoundToInt()
    if ( c )
        SetCharColor(-2)
    endif
  endif
  ++i;
endloop

